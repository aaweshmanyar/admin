<!DOCTYPE html>
<html lang="ur" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ایڈمن پینل - مسائل ورلڈ</title>
    <meta name="description" content="مسائل ورلڈ کے لیے ایڈمن پینل - فتاویٰ، مضامین، کتابیں، اور بہت کچھ کا نظم کریں۔">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Jameel+Noori+Nastaleeq&family=Lateef&family=Scheherazade+New&display=swap"
        rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>

    <style>
        @font-face {
            font-family: 'NaatFont';
            src: url('https://res.cloudinary.com/awescreative/raw/upload/v1749150996/Awes/naatfont.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: 'NaatFont', serif;
            font-size: 80%;
            overscroll-behavior: none;
        }

        .qalam-admin-page {
            display: none;
        }

        .qalam-admin-page.qalam-active {
            display: block;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #124559;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #0b2935;
        }

        .qalam-sidebar-link.qalam-active {
            background-color: #01161e;
            border-right: 4px solid #eff6e0;
        }

        @media (max-width: 768px) {
            .qalam-responsive-table thead {
                display: none;
            }

            .qalam-responsive-table tr {
                display: block;
                margin-bottom: 1.5rem;
                border: 1px solid #dee2e6;
                border-radius: 0.5rem;
                padding: 1rem;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            }

            .qalam-responsive-table td {
                display: block;
                text-align: left;
                padding: 0.5rem 0;
                border-bottom: 1px dashed #e5e7eb;
            }

            .qalam-responsive-table td:last-child {
                border-bottom: none;
            }

            .qalam-responsive-table td::before {
                content: attr(data-label);
                float: right;
                font-weight: bold;
                margin-left: 1rem;
            }
        }

        .qalam-dropdown-options {
            max-height: 150px;
            overflow-y: auto;
        }

        .qalam-dropdown-option {
            padding: 8px 12px;
            cursor: pointer;
        }

        .qalam-dropdown-option:hover {
            background-color: #f0f0f1;
        }

        .qalam-tag-pill {
            background-color: #124559;
            color: white;
            padding: 4px 8px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            font-size: 14px;
        }

        .qalam-tag-remove-btn {
            margin-right: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .qalam-rich-text-editor {
            background-color: white;
            border-radius: 0.5rem;
            border: 2px solid #aec3b0;
        }

        .ql-editor {
            min-height: 250px;
            font-family: 'Jameel Noori Nastaleeq', serif;
            font-size: 18px;
            direction: rtl;
            text-align: right;
        }

        .ql-snow .ql-picker.ql-font .ql-picker-label[data-value=jameel]::before,
        .ql-snow .ql-picker.ql-font .ql-picker-item[data-value=jameel]::before {
            content: 'نستعلیق';
            font-family: 'Jameel Noori Nastaleeq', serif;
        }

        .ql-snow .ql-picker.ql-font .ql-picker-label[data-value=lateef]::before,
        .ql-snow .ql-picker.ql-font .ql-picker-item[data-value=lateef]::before {
            content: 'لطیف';
            font-family: 'Lateef', cursive;
        }

        .ql-snow .ql-picker.ql-font .ql-picker-label[data-value=scheherazade]::before,
        .ql-snow .ql-picker.ql-font .ql-picker-item[data-value=scheherazade]::before {
            content: 'شہرزاد';
            font-family: 'Scheherazade New', serif;
        }

        .ql-toolbar.ql-snow {
            direction: ltr;
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rich_black': { DEFAULT: '#01161e', 100: '#000406', 200: '#00090c', 300: '#010d12', 400: '#011118', 500: '#01161e', 600: '#04597b', 700: '#079cd8', 800: '#45c6f9', 900: '#a2e3fc' },
                        'midnight_green': { DEFAULT: '#124559', 100: '#040e12', 200: '#071c24', 300: '#0b2935', 400: '#0f3747', 500: '#124559', 600: '#20799c', 700: '#36a9d6', 800: '#79c5e4', 900: '#bce2f1' },
                        'air_force_blue': { DEFAULT: '#598392', 100: '#121a1d', 200: '#24343a', 300: '#354e57', 400: '#476874', 500: '#598392', 600: '#769dab', 700: '#99b6c0', 800: '#bbced5', 900: '#dde7ea' },
                        'ash_gray': { DEFAULT: '#aec3b0', 100: '#1f2a20', 200: '#3e5441', 300: '#5e7f61', 400: '#83a386', 500: '#aec3b0', 600: '#bdcebf', 700: '#cedbcf', 800: '#dee7df', 900: '#eff3ef' },
                        'beige': { DEFAULT: '#eff6e0', 100: '#384915', 200: '#71912a', 300: '#a4cc4e', 400: '#c9e197', 500: '#eff6e0', 600: '#f2f8e6', 700: '#f5f9ec', 800: '#f8fbf2', 900: '#fcfdf9' }
                    }
                }
            }
        }
    </script>
</head>

<body class="text-rich_black bg-gray-100">

    <div class="flex h-screen">
        <aside id="ms-sidebar"
            class="w-64 bg-midnight_green text-beige flex-col shadow-2xl fixed top-0 right-0 h-full z-20 transition-transform duration-300 ease-in-out md:relative md:translate-x-0 translate-x-full">
            <div class="p-6 text-center border-b border-midnight_green-400">
                <h1 class="text-3xl font-bold">مسائل ورلڈ</h1>
                <p class="text-sm text-air_force_blue-700">ایڈمن پینل</p>
            </div>
            <nav class="flex-1 px-4 py-6 space-y-2">
                <a href="#dashboard"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-speedometer2 ml-3 text-2xl"></i>
                    <span>ڈیش بورڈ</span>
                </a>
                <a href="#manage-fatawa"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-journal-check ml-3 text-2xl"></i>
                    <span>فتاویٰ</span>
                </a>
                <a href="#manage-articles"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-pencil-square ml-3 text-2xl"></i>
                    <span>مضامین</span>
                </a>
                <a href="#manage-books"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-book-half ml-3 text-2xl"></i>
                    <span>کتابیں</span>
                </a>
                <a href="#manage-ulema"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-people-fill ml-3 text-2xl"></i>
                    <span>علمائے کرام</span>
                </a>
                <a href="#manage-categories"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-grid-fill ml-3 text-2xl"></i>
                    <span>موضوعات</span>
                </a>
                <a href="#manage-questions"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-patch-question-fill ml-3 text-2xl"></i>
                    <span>موصول سوالات</span>
                </a>
                <!-- <a href="#manage-submissions"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-send-check ml-3 text-2xl"></i>
                    <span>مفتی کی گذارشات</span>
                </a> -->
                <a href="#manage-users"
                    class="as-admin-nav-link as-sidebar-link qalam-sidebar-link flex items-center px-4 py-3 text-lg rounded-md hover:bg-rich_black transition">
                    <i class="bi bi-person-gear ml-3 text-2xl"></i>
                    <span>صارفین کا انتظام</span>
                </a>
            </nav>
            <div class="p-4 border-t border-midnight_green-400">
                <div class="flex items-center p-2 rounded-md hover:bg-rich_black transition">
                    <img src="https://placehold.co/40x40/eff6e0/124559?text=A" class="w-10 h-10 rounded-full"
                        onerror="this.onerror=null;this.src='https://placehold.co/40x40/eff6e0/124559?text=A';">
                    <div class="mr-3">
                        <p id="user-name" class="font-bold text-lg">ایڈمن</p>
                        <a href="../Login.html" class="text-sm text-air_force_blue-700 hover:text-beige">لاگ
                            آؤٹ</a>
                    </div>
                </div>
            </div>
        </aside>

        <div id="ms-sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-10 hidden md:hidden"></div>

        <div class="flex-1 flex flex-col">


            <header
                class="bg-white shadow-md p-4 flex flex-col md:flex-row md:justify-between md:items-center gap-3 sticky top-0 z-10">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <button id="ms-sidebar-toggle" class="text-midnight_green text-2xl ml-4">
                            <i class="bi bi-list"></i>
                        </button>
                        <div id="ms-breadcrumb" class="hidden md:block text-sm"></div>
                    </div>
                    <h1 class="text-xl font-bold text-midnight_green md:hidden">ایڈمن پینل</h1>
                </div>

                <!-- Global Search (added) -->
                <div class="w-full md:w-1/2 relative" dir="rtl">
                    <label for="ms-global-search" class="sr-only">تلاش کریں</label>
                    <div class="flex gap-2">
                        <input id="ms-global-search" type="text"
                            class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                            placeholder="تلاش کریں… (فتاویٰ، مضامین، کتابیں، علما وغیرہ)" />
                        <button id="ms-global-search-btn"
                            class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                            تلاش
                        </button>
                    </div>

                    <!-- Dropdown (added) -->
                    <ul id="ms-global-search-suggestions"
                        class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-72 overflow-auto hidden">
                        <!-- filled dynamically -->
                    </ul>
                </div>
            </header>


            <main class="flex-1 p-4 md:p-6 overflow-y-auto">
                <div id="ms-admin-main-content">
                    <div id="ms-page-dashboard" class="as-admin-page qalam-admin-page as-active qalam-active">
                        <div class="mb-8">
                            <h2 class="text-2xl font-bold text-midnight_green mb-4">فوری رسائی</h2>
                            <div class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-7 gap-4">
                                <button
                                    class="as-add-new-btn bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group"
                                    data-target="add-fatwa">
                                    <i
                                        class="bi bi-journal-plus text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">نیا فتویٰ</p>
                                </button>
                                <button
                                    class="as-add-new-btn bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group"
                                    data-target="add-article">
                                    <i
                                        class="bi bi-pencil-square text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">نیا مضمون</p>
                                </button>
                                <button
                                    class="as-add-new-btn bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group"
                                    data-target="add-book">
                                    <i class="bi bi-book-half text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">نئی کتاب</p>
                                </button>
                                <button
                                    class="as-add-new-btn bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group"
                                    data-target="add-ulema">
                                    <i
                                        class="bi bi-person-plus-fill text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">نئے عالم</p>
                                </button>
                                <button
                                    class="as-add-new-btn bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group"
                                    data-target="add-category">
                                    <i class="bi bi-grid text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">نیا موضوع</p>
                                </button>
                                <a href="#manage-questions"
                                    class="as-admin-nav-link bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group">
                                    <i
                                        class="bi bi-patch-question-fill text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">سوالات</p>
                                </a>
                                <a href="#manage-users"
                                    class="as-admin-nav-link bg-white p-3 rounded-xl shadow-lg text-center hover:bg-midnight_green hover:text-white transition-all duration-300 group">
                                    <i
                                        class="bi bi-person-gear text-3xl text-midnight_green group-hover:text-white"></i>
                                    <p class="mt-1 text-base font-bold">صارفین</p>
                                </a>
                            </div>
                        </div>



                        <div class="grid grid-cols-2 lg:grid-cols-4 gap-6">

                            <!-- Total Fatawa -->
                            <div onclick="window.location.href='index.html#manage-fatawa'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-midnight_green-600 hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">کل فتاویٰ</p>
                                        <p id="ms-total-fatawa" class="text-4xl font-bold text-rich_black mt-2">0</p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-journal-check text-3xl text-midnight_green"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Articles -->
                            <div onclick="window.location.href='index.html#manage-articles'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-air_force_blue hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">کل مضامین</p>
                                        <p id="ms-total-articles" class="text-4xl font-bold text-rich_black mt-2">0</p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-pencil-square text-3xl text-air_force_blue"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Books -->
                            <div onclick="window.location.href='index.html#manage-books'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-ash_gray hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">کل کتابیں</p>
                                        <p id="ms-total-books" class="text-4xl font-bold text-rich_black mt-2">0</p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-book-half text-3xl text-ash_gray-500"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Categories -->
                            <div onclick="window.location.href='index.html#manage-categories'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-midnight_green-700 hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">کل موضوعات</p>
                                        <p id="ms-total-categories" class="text-4xl font-bold text-rich_black mt-2">0
                                        </p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-grid-fill text-3xl text-midnight_green-700"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- New Questions -->
                            <div onclick="window.location.href='index.html#manage-questions'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-rich_black-700 hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">نئے سوالات</p>
                                        <p id="ms-total-questions" class="text-4xl font-bold text-rich_black mt-2">0</p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-patch-question-fill text-3xl text-rich_black-700"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Users -->
                            <div onclick="window.location.href='index.html#manage-users'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-beige-300 hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">کل صارفین</p>
                                        <p id="ms-total-users" class="text-4xl font-bold text-rich_black mt-2">0</p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-people text-3xl text-beige-400"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Pending Submissions -->
                            <div onclick="window.location.href='index.html#manage-submissions'"
                                class="cursor-pointer bg-white p-6 rounded-xl shadow-lg border-t-4 border-yellow-500 hover:shadow-xl transition">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-xl text-air_force_blue">التوا میں گذارشات</p>
                                        <p id="ms-total-submissions" class="text-4xl font-bold text-rich_black mt-2">0
                                        </p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full">
                                        <i class="bi bi-send-exclamation text-3xl text-yellow-600"></i>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- ==== Recent Activity (تازہ ترین سرگرمیاں) ==== -->
                        <section id="ms-recent-activity" class="mt-10">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-2xl font-bold text-midnight_green">
                                    تازہ ترین سرگرمیاں (Recent Activity)
                                </h2>
                                <div id="ms-recent-activity-loader" class="hidden">
                                    <div class="inline-flex items-center gap-2 text-air_force_blue text-sm">
                                        <span
                                            class="w-4 h-4 border-2 border-midnight_green border-t-transparent rounded-full animate-spin"></span>
                                        لوڈ ہو رہا ہے…
                                    </div>
                                </div>
                            </div>

                            <!-- Cards grid -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

                                <!-- Books -->
                                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-rich_black">کتب (Books)</h3>
                                        <a href="index.html#manage-books"
                                            class="text-sm text-midnight_green hover:underline">مزید</a>
                                    </div>
                                    <ul id="ms-activity-books" class="space-y-2"></ul>
                                </div>

                                <!-- Articles -->
                                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-rich_black">مضامین (Articles)</h3>
                                        <a href="index.html#manage-articles"
                                            class="text-sm text-midnight_green hover:underline">مزید</a>
                                    </div>
                                    <ul id="ms-activity-articles" class="space-y-2"></ul>
                                </div>

                                <!-- Fatawa -->
                                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-rich_black">فتاویٰ (Fatawa)</h3>
                                        <a href="index.html#manage-fatawa"
                                            class="text-sm text-midnight_green hover:underline">مزید</a>
                                    </div>
                                    <ul id="ms-activity-fatawa" class="space-y-2"></ul>
                                </div>

                                <!-- Ulema -->
                                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-rich_black">علمائے کرام (Ulema)</h3>
                                        <a href="index.html#manage-ulema"
                                            class="text-sm text-midnight_green hover:underline">مزید</a>
                                    </div>
                                    <ul id="ms-activity-ulema" class="space-y-2"></ul>
                                </div>

                                <!-- Tags -->
                                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-rich_black">موضوعات (Tags)</h3>
                                        <a href="index.html#manage-categories"
                                            class="text-sm text-midnight_green hover:underline">مزید</a>
                                    </div>
                                    <ul id="ms-activity-tags" class="space-y-2"></ul>
                                </div>

                                <!-- Users -->
                                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100">
                                    <div class="flex items-center justify-between mb-3">
                                        <h3 class="text-lg font-semibold text-rich_black">صارفین (Users)</h3>
                                        <a href="index.html#manage-users"
                                            class="text-sm text-midnight_green hover:underline">مزید</a>
                                    </div>
                                    <ul id="ms-activity-users" class="space-y-2"></ul>
                                </div>

                            </div>
                        </section>



                    </div>

                    <!-- Listing of fatawa -->
                    <!-- <div id="ms-page-manage-fatawa" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">فتاویٰ کا انتظام</h1>
                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-fatwa">نیا فتویٰ شامل کریں</button>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">نمبر</th>
                                        <th class="py-3 px-4">عنوان</th>
                                        <th class="py-3 px-4">مفتی صاحب</th>
                                        <th class="py-3 px-4">تاریخ</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-fatawa-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->


                    <!-- <div id="ms-page-manage-fatawa" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">فتاویٰ کا انتظام</h1>

                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-fatawa-search" class="sr-only">فتویٰ تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-fatawa-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="فتویٰ تلاش کریں (نمبر، عنوان، مفتی، تاریخ)…" />
                                    <button id="ms-fatawa-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <ul id="ms-fatawa-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                    
                                </ul>
                            </div>

                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-fatwa">نیا فتویٰ شامل کریں</button>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">نمبر</th>
                                        <th class="py-3 px-4">عنوان</th>
                                        <th class="py-3 px-4">مفتی صاحب</th>
                                        <th class="py-3 px-4">تاریخ</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-fatawa-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->


                    <div id="ms-page-manage-fatawa" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">فتاویٰ کا انتظام</h1>

                            <!-- Search + button + suggestions -->
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-fatawa-search" class="sr-only">فتویٰ تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-fatawa-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="فتویٰ تلاش کریں (نمبر، عنوان، مفتی، تاریخ)…" />
                                    <button id="ms-fatawa-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <!-- Suggestions dropdown -->
                                <ul id="ms-fatawa-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                    <!-- filled dynamically -->
                                </ul>
                            </div>

                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <button id="ms-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد فتاویٰ حذف کریں
                                </button>

                                <button
                                    class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                    data-target="add-fatwa">
                                    نیا فتویٰ شامل کریں
                                </button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <th class="py-3 px-4">نمبر</th>
                                            <th class="py-3 px-4">عنوان</th>
                                            <th class="py-3 px-4">مفتی صاحب</th>
                                            <th class="py-3 px-4">حالت</th>
                                            <th class="py-3 px-4">تاریخ</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-fatawa-table-body"></tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            <div id="ms-fatawa-pagination" class="mt-4 flex flex-wrap items-center justify-center gap-2"
                                dir="rtl">
                                <!-- buttons inserted dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- Add Fatawa -->
                    <div id="ms-page-add-fatwa" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 id="ms-fatwa-form-title" class="text-3xl md:text-4xl font-bold text-midnight_green">نیا
                                فتویٰ شامل کریں</h1>
                            <a href="#manage-fatawa"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <form id="ms-fatwa-form" class="space-y-6">
                                <input type="hidden" id="ms-fatwa-id">
                                <div>
                                    <label for="ms-fatwa-title"
                                        class="block text-xl font-bold text-midnight_green mb-2">عنوان</label>
                                    <input type="text" id="ms-fatwa-title"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        required>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="ms-fatwa-slug"
                                            class="block text-xl font-bold text-midnight_green mb-2">URL سلگ</label>
                                        <input type="text" id="ms-fatwa-slug"
                                            class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg font-sans"
                                            style="direction: ltr;" placeholder="auto-generated-slug">
                                    </div>
                                    <div>
                                        <label for="ms-fatwa-keywords-input"
                                            class="block text-xl font-bold text-midnight_green mb-2">کلیدی الفاظ
                                            (Tags)</label>
                                        <div class="relative">
                                            <div id="ms-fatwa-keywords-container"
                                                class="as-tag-input-container w-full border-2 border-ash_gray rounded-lg focus-within:ring-2 focus-within:ring-midnight_green p-2 flex flex-wrap gap-2 items-center">
                                                <input type="text" id="ms-fatwa-keywords-input"
                                                    class="as-tag-input-field flex-grow focus:outline-none bg-transparent text-rich_black text-lg"
                                                    placeholder="ٹیگ شامل کریں...">
                                            </div>
                                            <input type="hidden" id="ms-fatwa-keywords">
                                        </div>
                                    </div>

                                    <div>
                                        <label for="ms-fatwa-mozuwat"
                                            class="block text-xl font-bold text-midnight_green mb-2">Mozuwat</label>
                                        <div class="relative">
                                            <select id="ms-fatwa-mozuwat" class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none 
             focus:ring-2 focus:ring-midnight_green text-rich_black text-lg">
                                                <option value="">-- موزوٰع منتخب کریں --</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <label for="ms-fatwa-meta-description"
                                        class="block text-xl font-bold text-midnight_green mb-2">SEO تفصیل</label>
                                    <textarea id="ms-fatwa-meta-description" rows="3"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        placeholder="فتویٰ کے بارے میں 150-160 حروف کی مختصر تفصیل"></textarea>
                                </div>
                                <div>
                                    <label for="ms-fatwa-question"
                                        class="block text-xl font-bold text-midnight_green mb-2">سوال</label>
                                    <div id="ms-fatwa-question" class="qalam-rich-text-editor"></div>
                                </div>
                                <div>
                                    <label for="ms-fatwa-answer"
                                        class="block text-xl font-bold text-midnight_green mb-2">الجواب</label>
                                    <div id="ms-fatwa-answer" class="qalam-rich-text-editor"></div>
                                </div>
                                <div>
                                    <label for="ms-fatwa-mufti"
                                        class="block text-xl font-bold text-midnight_green mb-2">مفتی صاحب</label>
                                    <div class="relative as-searchable-dropdown">
                                        <input type="text" id="ms-fatwa-mufti"
                                            class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                            required autocomplete="off">
                                        <div
                                            class="as-dropdown-options qalam-dropdown-options absolute z-10 w-full bg-white border rounded-md mt-1 hidden shadow-lg">
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button type="submit"
                                        class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">پبلش
                                        کریں</button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-fatawa">منسوخ کریں</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Listing a Articles -->
                    <!-- <div id="ms-page-manage-articles" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">مضامین کا انتظام</h1>
                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-article">نیا مضمون شامل کریں</button>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">عنوان</th>
                                        <th class="py-3 px-4">مصنف</th>
                                        <th class="py-3 px-4">تاریخ</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-articles-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->

                    <!-- <div id="ms-page-manage-articles" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">مضامین کا انتظام</h1>

                           
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-articles-search" class="sr-only">مضمون تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-articles-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="مضمون تلاش کریں (عنوان، مصنف، تاریخ)…" />
                                    <button id="ms-articles-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                
                                <ul id="ms-articles-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                    
                                </ul>
                            </div>

                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-article">نیا مضمون شامل کریں</button>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">عنوان</th>
                                        <th class="py-3 px-4">مصنف</th>
                                        <th class="py-3 px-4">تاریخ</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-articles-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->

                    <div id="ms-page-manage-articles" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">مضامین کا انتظام</h1>

                            <!-- Search + button + suggestions -->
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-articles-search" class="sr-only">مضمون تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-articles-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="مضمون تلاش کریں (عنوان، مصنف، تاریخ)…" />
                                    <button id="ms-articles-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <!-- Suggestions dropdown -->
                                <ul id="ms-articles-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                    <!-- filled dynamically -->
                                </ul>
                            </div>

                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <button id="ms-articles-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد مضامین حذف کریں
                                </button>

                                <button
                                    class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                    data-target="add-article">نیا مضمون شامل کریں</button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-articles-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <th class="py-3 px-4">عنوان</th>
                                            <th class="py-3 px-4">مصنف</th>
                                            <th class="py-3 px-4">تاریخ</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-articles-table-body"></tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            <div id="ms-articles-pagination"
                                class="mt-4 flex flex-wrap items-center justify-center gap-2" dir="rtl">
                                <!-- buttons inserted dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- Adding Articles -->
                    <div id="ms-page-add-article" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 id="ms-article-form-title" class="text-3xl md:text-4xl font-bold text-midnight_green">
                                نیا مضمون شامل کریں</h1>
                            <a href="#manage-articles"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>

                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <form id="ms-article-form" class="space-y-6">
                                <input type="hidden" id="ms-article-id">

                                <div>
                                    <label for="ms-article-title"
                                        class="block text-xl font-bold text-midnight_green mb-2">عنوان</label>
                                    <input type="text" id="ms-article-title"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        required>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="ms-article-slug"
                                            class="block text-xl font-bold text-midnight_green mb-2">URL سلگ</label>
                                        <input type="text" id="ms-article-slug"
                                            class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg font-sans"
                                            style="direction: ltr;" placeholder="auto-generated-slug">
                                    </div>

                                    <div>
                                        <label for="ms-article-keywords-input"
                                            class="block text-xl font-bold text-midnight_green mb-2">کلیدی الفاظ
                                            (Tags)</label>
                                        <div class="relative">
                                            <!-- tag container: pills inserted before the input -->
                                            <div id="ms-article-keywords-container"
                                                class="as-tag-input-container w-full border-2 border-ash_gray rounded-lg focus-within:ring-2 focus-within:ring-midnight_green p-2 flex flex-wrap gap-2 items-center">
                                                <input type="text" id="ms-article-keywords-input"
                                                    class="as-tag-input-field flex-grow focus:outline-none bg-transparent text-rich_black text-lg"
                                                    placeholder="ٹیگ شامل کریں...">
                                            </div>
                                            <!-- hidden input that actually gets submitted as 'tags' -->
                                            <input type="hidden" id="ms-article-keywords" name="tags" value="">
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label for="ms-article-meta-description"
                                        class="block text-xl font-bold text-midnight_green mb-2">SEO تفصیل</label>
                                    <textarea id="ms-article-meta-description" rows="3"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        placeholder="مضمون کے بارے میں 150-160 حروف کی مختصر تفصیل"></textarea>
                                </div>

                                <div>
                                    <label for="ms-article-author"
                                        class="block text-xl font-bold text-midnight_green mb-2">مصنف</label>
                                    <div class="relative as-searchable-dropdown">
                                        <input type="text" id="ms-article-author"
                                            class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                            required autocomplete="off">
                                        <div
                                            class="as-dropdown-options qalam-dropdown-options absolute z-10 w-full bg-white border rounded-md mt-1 hidden shadow-lg">
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label for="ms-article-image"
                                        class="block text-xl font-bold text-midnight_green mb-2">نمایاں تصویر</label>
                                    <input type="file" id="ms-article-image" accept="image/*"
                                        class="w-full text-lg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-beige file:text-midnight_green hover:file:bg-ash_gray">
                                    <!-- preview -->
                                    <img id="ms-article-image-preview" class="mt-2 max-h-40 rounded-md hidden"
                                        alt="Cover preview">
                                </div>

                                <div>
                                    <label for="ms-article-content"
                                        class="block text-xl font-bold text-midnight_green mb-2">مضمون کا متن</label>
                                    <!-- This container will host Quill if available, otherwise acts as editable container -->
                                    <div id="ms-article-content" class="qalam-rich-text-editor"
                                        style="min-height: 200px; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 12px;">
                                    </div>
                                </div>

                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button type="submit" id="ms-article-submit"
                                        class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">پبلش
                                        کریں</button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-articles">منسوخ کریں</button>
                                </div>
                            </form>
                        </div>
                    </div>


                    <!-- Listing a Book -->
                    

                    <div id="ms-page-manage-books" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">کتابوں کا انتظام</h1>

                            <!-- Search + button + suggestions -->
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-books-search" class="sr-only">کتاب تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-books-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="کتاب تلاش کریں (نام، مصنف)…" />
                                    <button id="ms-books-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <!-- Suggestions dropdown (optional) -->
                                <ul id="ms-books-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                    <!-- filled dynamically if you wire it -->
                                </ul>
                            </div>

                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <button id="ms-books-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد کتابیں حذف کریں
                                </button>

                                <button
                                    class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                    data-target="add-book">نئی کتاب شامل کریں</button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-books-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <th class="py-3 px-4">کتاب کا نام</th>
                                            <th class="py-3 px-4">مصنف</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-books-table-body"></tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            <div id="ms-books-pagination" class="mt-4 flex flex-wrap items-center justify-center gap-2"
                                dir="rtl">
                                <!-- buttons inserted dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- Add a Book -->
                     <div id="ms-page-add-book" class="as-admin-page qalam-admin-page max-w-5xl mx-auto p-4 md:p-8">
    <div class="flex justify-between items-center mb-8">
      <h1 id="ms-book-form-title" class="text-3xl md:text-4xl font-bold text-midnight_green">
        نئی کتاب شامل کریں
      </h1>
      <a href="#manage-books"
         class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
        <i class="bi bi-arrow-right ml-2"></i>
        فہرست پر واپس جائیں
      </a>
    </div>

    <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
      <form id="ms-book-form" class="space-y-6">
        <input type="hidden" id="ms-book-id">

        <!-- Book Name -->
        <div>
          <label for="ms-book-name" class="block text-xl font-bold text-midnight_green mb-2">کتاب کا نام</label>
          <input type="text" id="ms-book-name"
                 class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                 required>
        </div>

        <!-- Author (simple searchable input with dropdown shell already present) -->
        <div>
          <label for="ms-book-author" class="block text-xl font-bold text-midnight_green mb-2">مصنف</label>
          <div class="relative as-searchable-dropdown">
            <input type="text" id="ms-book-author"
                   class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                   required autocomplete="off">
            <div class="as-dropdown-options qalam-dropdown-options absolute z-10 w-full bg-white border rounded-md mt-1 hidden shadow-lg"></div>
          </div>
        </div>

        <!-- Description (rich text container) -->
        <div>
          <label for="ms-book-description" class="block text-xl font-bold text-midnight_green mb-2">کتاب کا تعارف</label>
          <div id="ms-book-description" class="qalam-rich-text-editor min-h-[140px] border-2 border-ash_gray rounded-lg p-3"></div>
        </div>

        <!-- NEW: Tags (multi-select searchable) -->
        <div>
          <label class="block text-xl font-bold text-midnight_green mb-2">ٹیگز</label>

          <!-- Selected tags pills -->
          <div id="ms-book-tags-selected" class="flex flex-wrap gap-2 mb-2"></div>

          <div class="relative">
            <input type="text" id="ms-book-tags-input" autocomplete="off" placeholder="ٹیگ تلاش کریں…"
                   class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg">
            <div id="ms-book-tags-options"
                 class="qalam-dropdown-options absolute z-10 w-full bg-white border rounded-md mt-1 hidden shadow-lg"></div>
          </div>

          <!-- Hidden field (for graceful non-Fetch fallbacks if needed) -->
          <input type="hidden" id="ms-book-tags-hidden" value="">
          <p class="text-sm text-gray-500 mt-1">آپ کئی ٹیگز منتخب کر سکتے ہیں۔</p>
        </div>

        <!-- Cover -->
        <div>
          <label for="ms-book-cover" class="block text-xl font-bold text-midnight_green mb-2">کتاب کا کور</label>
          <input type="file" id="ms-book-cover"
                 class="w-full text-lg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-beige file:text-midnight_green hover:file:bg-ash_gray">
        </div>

        <!-- PDF -->
        <div>
          <label for="ms-book-file" class="block text-xl font-bold text-midnight_green mb-2">PDF فائل</label>
          <input type="file" id="ms-book-file"
                 class="w-full text-lg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-beige file:text-midnight_green hover:file:bg-ash_gray">
        </div>

        <!-- Actions -->
        <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
          <button type="submit"
                  class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">
            پبلش کریں
          </button>
          <button type="button"
                  class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                  data-target="manage-books">
            منسوخ کریں
          </button>
        </div>
      </form>
    </div>
  </div>




                    <!-- Listing a Ulema -->
                    <!-- <div id="ms-page-manage-ulema" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">علمائے کرام کا انتظام</h1>
                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-ulema">نئے عالم شامل کریں</button>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">نام</th>
                                        <th class="py-3 px-4">عہدہ</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-ulema-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->


                    <!-- <div id="ms-page-manage-ulema" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">علمائے کرام کا انتظام</h1>

                            
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-ulema-search" class="sr-only">عالم تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-ulema-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="عالم تلاش کریں (نام، عہدہ)…" />
                                    <button id="ms-ulema-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                              
                                <ul id="ms-ulema-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                               
                                </ul>
                            </div>

                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-ulema">نئے عالم شامل کریں</button>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">نام</th>
                                        <th class="py-3 px-4">عہدہ</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-ulema-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->

                    <!-- ==== Manage Ulema Page (unchanged IDs/classes) ==== -->
                    <div id="ms-page-manage-ulema" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">علمائے کرام کا انتظام</h1>

                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-ulema-search" class="sr-only">عالم تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-ulema-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="عالم تلاش کریں (نام، عہدہ)…" />
                                    <button id="ms-ulema-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <ul id="ms-ulema-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                </ul>
                            </div>

                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <button id="ms-ulema-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد علما حذف کریں
                                </button>

                                <button
                                    class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                    data-target="add-ulema">نئے عالم شامل کریں</button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-ulema-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <th class="py-3 px-4">نام</th>
                                            <th class="py-3 px-4">عہدہ</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-ulema-table-body"></tbody>
                                </table>
                            </div>

                            <div id="ms-ulema-pagination" class="mt-4 flex flex-wrap items-center justify-center gap-2"
                                dir="rtl"></div>
                        </div>
                    </div>

                    <!-- ==== Quick View Modal (unchanged IDs/classes) ==== -->
                    <div id="ms-ulema-modal" class="fixed inset-0 z-50 hidden">
                        <div class="absolute inset-0 bg-black/60"></div>
                        <div class="relative max-w-xl mx-auto mt-24 bg-white rounded-2xl shadow-xl overflow-hidden">
                            <div class="flex items-center justify-between px-5 py-4 border-b">
                                <h3 class="text-xl font-semibold text-midnight_green">عالم کی تفصیل</h3>
                                <button id="ms-ulema-modal-close"
                                    class="text-gray-500 hover:text-gray-800 text-2xl leading-none">&times;</button>
                            </div>
                            <div class="p-5">
                                <div class="flex gap-4 items-start">
                                    <img id="ms-ulema-modal-photo" src="" alt="Profile"
                                        class="w-24 h-24 rounded-xl object-cover bg-gray-100">
                                    <div class="flex-1">
                                        <div class="text-lg font-bold" id="ms-ulema-modal-name">—</div>
                                        <div class="text-sm text-gray-600" id="ms-ulema-modal-position">—</div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <div class="text-sm text-gray-800 leading-7" id="ms-ulema-modal-about">—</div>
                                </div>
                            </div>
                            <div class="px-5 py-4 border-t flex justify-end">
                                <button id="ms-ulema-modal-ok"
                                    class="px-4 py-2 rounded-lg bg-midnight_green text-white hover:bg-midnight_green-400">
                                    بند کریں
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ==== Global overlay spinner (added) ==== -->
                    <div id="ulema-global-loader" class="fixed inset-0 hidden z-50">
                        <div class="absolute inset-0 bg-black/50"></div>
                        <div class="relative w-full h-full flex items-center justify-center">
                            <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin">
                            </div>
                        </div>
                    </div>

                    <!-- ==== Upload progress overlay (added) ==== -->
                    <div id="ulema-upload-overlay" class="fixed inset-0 hidden z-50">
                        <div class="absolute inset-0 bg-black/60"></div>
                        <div class="relative max-w-md mx-auto mt-40 bg-white rounded-2xl shadow-xl p-6">
                            <h3 class="text-lg font-semibold text-midnight_green mb-4">تصویر اپلوڈ ہو رہی ہے…</h3>
                            <div class="w-full h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div id="ulema-upload-bar" class="h-3 bg-midnight_green" style="width:0%"></div>
                            </div>
                            <div id="ulema-upload-text" class="mt-3 text-sm text-gray-700 text-center">0%</div>
                        </div>
                    </div>

                    <!-- ==== Add Ulema Page (unchanged IDs/classes) ==== -->
                    <div id="ms-page-add-ulema" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 id="ms-ulema-form-title" class="text-3xl md:text-4xl font-bold text-midnight_green">
                                نئے عالم شامل کریں
                            </h1>
                            <a href="#manage-ulema"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <form id="ms-ulema-form" class="space-y-6">
                                <input type="hidden" id="ms-ulema-id">
                                <div>
                                    <label for="ms-ulema-name"
                                        class="block text-xl font-bold text-midnight_green mb-2">نام</label>
                                    <input type="text" id="ms-ulema-name"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        required>
                                </div>
                                <div>
                                    <label for="ms-ulema-designation"
                                        class="block text-xl font-bold text-midnight_green mb-2">عہدہ</label>
                                    <input type="text" id="ms-ulema-designation"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        required>
                                </div>
                                <div>
                                    <label for="ms-ulema-photo"
                                        class="block text-xl font-bold text-midnight_green mb-2">تصویر</label>
                                    <input type="file" id="ms-ulema-photo" accept="image/*"
                                        class="w-full text-lg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-beige file:text-midnight_green hover:file:bg-ash_gray">
                                    <!-- (optional) local preview -->
                                    <div class="mt-3">
                                        <img id="ms-ulema-photo-preview"
                                            class="w-24 h-24 object-cover rounded-xl hidden" alt="Preview">
                                    </div>
                                </div>
                                <div>
                                    <label for="ms-ulema-bio"
                                        class="block text-xl font-bold text-midnight_green mb-2">مختصر تعارف</label>
                                    <div id="ms-ulema-bio" class="qalam-rich-text-editor"></div>
                                </div>
                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button type="submit"
                                        class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        پبلش کریں
                                    </button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-ulema">
                                        منسوخ کریں
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- Listing Category -->

                    <!-- <div id="ms-page-manage-categories" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">موضوعات کا انتظام</h1>
                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-category">نیا موضوع شامل کریں</button>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">تھمبنیل</th>
                                        <th class="py-3 px-4">موضوع کا نام</th>
                                        <th class="py-3 px-4">آئیکن</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-categories-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->


                    <!-- <div id="ms-page-manage-categories" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">موضوعات کا انتظام</h1>

                            
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-categories-search" class="sr-only">موضوع تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-categories-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="موضوع تلاش کریں (نام، آئیکن)…" />
                                    <button id="ms-categories-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                              
                                <ul id="ms-categories-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                               
                                </ul>
                            </div>

                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-category">نیا موضوع شامل کریں</button>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">تھمبنیل</th>
                                        <th class="py-3 px-4">موضوع کا نام</th>
                                        <th class="py-3 px-4">آئیکن</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-categories-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->

                    <!-- ==== Manage Categories Page (unchanged main IDs/classes) ==== -->
                    <div id="ms-page-manage-categories" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">موضوعات کا انتظام</h1>

                            <!-- Search + suggestions -->
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-categories-search" class="sr-only">موضوع تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-categories-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="موضوع تلاش کریں (نام، آئیکن)…" autocomplete="off" />
                                    <button id="ms-categories-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>
                                <ul id="ms-categories-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                </ul>
                            </div>

                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <!-- Bulk delete -->
                                <button id="ms-categories-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد موضوعات حذف کریں
                                </button>

                                <button
                                    class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                    data-target="add-category">
                                    نیا موضوع شامل کریں
                                </button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-categories-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <th class="py-3 px-4">آئی ڈی</th>
                                            <th class="py-3 px-4">تھمبنیل</th>
                                            <th class="py-3 px-4">موضوع کا نام</th>
                                            <th class="py-3 px-4">آئیکن</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-categories-table-body"></tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            <div id="ms-categories-pagination"
                                class="mt-4 flex flex-wrap items-center justify-center gap-2" dir="rtl"></div>
                        </div>

                        <!-- Minimal global loader -->
                        <div id="categories-global-loader"
                            class="hidden fixed inset-0 bg-black/10 backdrop-blur-sm flex items-center justify-center z-50"
                            aria-hidden="true">
                            <div class="bg-white rounded-xl shadow p-4 text-midnight_green">Loading…</div>
                        </div>
                    </div>

                    <!-- Global overlay spinner -->
                    <div id="categories-global-loader" class="fixed inset-0 hidden z-50">
                        <div class="absolute inset-0 bg-black/50"></div>
                        <div class="relative w-full h-full flex items-center justify-center">
                            <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin">
                            </div>
                        </div>
                    </div>




                    <!-- Add Category -->
                    <div id="ms-page-add-category" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 id="ms-category-form-title" class="text-3xl md:text-4xl font-bold text-midnight_green">
                                نیا موضوع شامل کریں
                            </h1>
                            <a href="#manage-categories"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>

                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <form id="ms-category-form" class="space-y-6">
                                <input type="hidden" id="ms-category-id">

                                <!-- Name -->
                                <div>
                                    <label for="ms-category-name"
                                        class="block text-xl font-bold text-midnight_green mb-2">موضوع کا نام</label>
                                    <input type="text" id="ms-category-name"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        required>
                                </div>

                                <!-- Slug -->
                                <div>
                                    <label for="ms-category-slug"
                                        class="block text-xl font-bold text-midnight_green mb-2">URL سلگ</label>
                                    <input type="text" id="ms-category-slug"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg font-sans"
                                        style="direction:ltr;" placeholder="auto-generated-slug">
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Icon picker (custom dropdown + hidden input with the same id) -->
                                    <div>
                                        <label class="block text-xl font-bold text-midnight_green mb-2">آئیکن منتخب
                                            کریں</label>

                                        <!-- Hidden value that your form submits (keeps id the same) -->
                                        <input type="hidden" id="ms-category-icon" name="iconClass" required>

                                        <!-- Trigger / display -->
                                        <button type="button" id="ms-icon-trigger"
                                            class="w-full flex items-center justify-between py-3 px-4 border-2 border-ash_gray rounded-lg hover:border-midnight_green focus:outline-none focus:ring-2 focus:ring-midnight_green">
                                            <span class="flex items-center gap-3">
                                                <i id="ms-icon-current" class="text-2xl"></i>
                                                <span id="ms-icon-current-label"
                                                    class="text-lg text-rich_black">—</span>
                                            </span>
                                            <i class="bi bi-chevron-down text-xl"></i>
                                        </button>

                                        <!-- Dropdown panel -->
                                        <div id="ms-icon-panel" class="relative">
                                            <div class="absolute z-50 mt-2 w-full bg-white rounded-xl border border-ash_gray shadow-xl p-3 hidden"
                                                role="listbox" aria-label="Icon list">
                                                <!-- Filter -->
                                                <input id="ms-icon-filter" type="text"
                                                    placeholder="آئیکن تلاش کریں (مثال: book, gem, star)"
                                                    class="mb-3 w-full py-2 px-3 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-base" />

                                                <!-- List -->
                                                <div id="ms-icon-list"
                                                    class="max-h-64 overflow-auto divide-y divide-ash_gray/30"
                                                    style="scrollbar-width: thin;">
                                                    <!-- rows injected by JS -->
                                                </div>
                                            </div>
                                        </div>

                                        <!-- helper + big preview -->
                                        <div class="mt-3 flex items-center gap-3">
                                            <span class="text-sm text-air_force_blue">بوٹسٹریپ آئیکنز میں سے انتخاب
                                                کریں۔</span>
                                            <i id="ms-icon-preview" class="text-3xl"></i>
                                        </div>
                                    </div>

                                    <!-- Thumbnail -->
                                    <div>
                                        <label for="ms-category-thumbnail"
                                            class="block text-xl font-bold text-midnight_green mb-2">موضوع کا
                                            تھمبنیل</label>
                                        <input type="file" id="ms-category-thumbnail"
                                            class="w-full text-lg file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-beige file:text-midnight_green hover:file:bg-ash_gray">
                                    </div>
                                </div>

                                <!-- Description -->
                                <div>
                                    <label for="ms-category-description"
                                        class="block text-xl font-bold text-midnight_green mb-2">موضوع کا تعارف</label>
                                    <div id="ms-category-description" class="qalam-rich-text-editor"></div>
                                </div>

                                <!-- Actions -->
                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button type="submit"
                                        class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        پبلش کریں
                                    </button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-categories">
                                        منسوخ کریں
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>


                    <!-- Listing a Question  -->
                    <!-- <div id="ms-page-manage-questions" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">موصول سوالات</h1>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">صارف</th>
                                        <th class="py-3 px-4">سوال کا خلاصہ</th>
                                        <th class="py-3 px-4">کیفیت</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-questions-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->

                    <!-- ==== Manage Questions Page (unchanged main wrapper ID) ==== -->
                    <div id="ms-page-manage-questions" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">موصول سوالات</h1>

                            <!-- Search + suggestions -->
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-questions-search" class="sr-only">سوال تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-questions-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="سوال تلاش کریں (صارف، خلاصہ، کیفیت)…" />
                                    <button id="ms-questions-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <!-- Suggestions dropdown (kept hidden unless you wire it later) -->
                                <ul id="ms-questions-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                </ul>
                            </div>

                            <!-- Bulk delete -->
                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <button id="ms-questions-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد سوالات حذف کریں
                                </button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <!-- Select-all -->
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-questions-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <th class="py-3 px-4">آئی ڈی</th>
                                            <th class="py-3 px-4">صارف</th>
                                            <th class="py-3 px-4">سوال کا خلاصہ</th>
                                            <th class="py-3 px-4">کیفیت</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-questions-table-body"></tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            <div id="ms-questions-pagination"
                                class="mt-4 flex flex-wrap items-center justify-center gap-2" dir="rtl"></div>
                        </div>
                    </div>

                    <!-- Global overlay spinner -->
                    <div id="questions-global-loader" class="fixed inset-0 hidden z-50">
                        <div class="absolute inset-0 bg-black/50"></div>
                        <div class="relative w-full h-full flex items-center justify-center">
                            <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin">
                            </div>
                        </div>
                    </div>


                    <!-- Answer Questions -->
                    <div id="ms-page-answer-question" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">سوال کا جواب دیں</h1>
                            <a href="#manage-questions"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <div class="mb-6 pb-6 border-b border-ash_gray">
                                <h2 class="text-xl font-bold text-midnight_green">صارف کا سوال:</h2>
                                <p id="ms-question-to-answer-text" class="text-2xl font-semibold my-2 text-rich_black">
                                </p>
                                <p id="ms-question-to-answer-user" class="text-air_force_blue"></p>
                            </div>
                            <form id="ms-answer-form" class="space-y-6">
                                <input type="hidden" id="ms-question-id">
                                <div>
                                    <label for="ms-question-answer"
                                        class="block text-xl font-bold text-midnight_green mb-2">الجواب</label>
                                    <div id="ms-question-answer" class="qalam-rich-text-editor"></div>
                                </div>
                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button type="submit"
                                        class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">جواب
                                        بھیجیں</button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-questions">منسوخ کریں</button>
                                </div>
                            </form>
                        </div>
                    </div>


                    <!-- Listing of Users -->
                    <!-- <div id="ms-page-manage-users" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">صارفین کا انتظام</h1>
                            <button
                                class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                data-target="add-user">نیا صارف شامل کریں</button>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">نام</th>
                                        <th class="py-3 px-4">ای میل</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-users-table-body"></tbody>
                            </table>
                        </div>
                    </div> -->

                    <!-- ==== Manage Users Page (unchanged main wrapper ID) ==== -->
                    <div id="ms-page-manage-users" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">صارفین کا انتظام</h1>

                            <!-- Search + suggestions -->
                            <div class="w-full md:w-1/2 relative" dir="rtl">
                                <label for="ms-users-search" class="sr-only">صارف تلاش کریں</label>
                                <div class="flex gap-2">
                                    <input id="ms-users-search" type="text"
                                        class="w-full border border-gray-300 rounded-lg py-3 px-4 text-lg focus:outline-none focus:ring-2 focus:ring-midnight_green"
                                        placeholder="صارف تلاش کریں (نام، ای میل)…" />
                                    <button id="ms-users-search-btn"
                                        class="bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition">
                                        تلاش
                                    </button>
                                </div>

                                <!-- Suggestions dropdown (kept hidden unless you wire it later) -->
                                <ul id="ms-users-suggestions"
                                    class="absolute z-20 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto hidden">
                                </ul>
                            </div>

                            <div class="flex items-center gap-2 w-full md:w-auto">
                                <!-- NEW: bulk delete -->
                                <button id="ms-users-bulk-delete-btn"
                                    class="bg-red-600 text-white py-3 px-4 rounded-lg text-lg hover:bg-red-700 transition disabled:opacity-50"
                                    disabled>
                                    متعدد صارفین حذف کریں
                                </button>

                                <button
                                    class="as-add-new-btn bg-midnight_green text-white py-3 px-6 rounded-lg text-lg hover:bg-midnight_green-400 transition w-full md:w-auto"
                                    data-target="#add-user">نیا صارف شامل کریں</button>
                            </div>
                        </div>

                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <div class="overflow-x-auto">
                                <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                    <thead>
                                        <tr class="border-b-2 border-gray-200">
                                            <!-- NEW: select-all -->
                                            <th class="py-3 px-4 w-10">
                                                <input id="ms-users-select-all" type="checkbox"
                                                    class="w-5 h-5 accent-midnight_green" />
                                            </th>
                                            <!-- NEW: ID column -->
                                            <th class="py-3 px-4">آئی ڈی</th>
                                            <th class="py-3 px-4">نام</th>
                                            <th class="py-3 px-4">ای میل</th>
                                            <th class="py-3 px-4">اعمال</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ms-users-table-body"></tbody>
                                </table>
                            </div>

                            <!-- NEW: pagination -->
                            <div id="ms-users-pagination" class="mt-4 flex flex-wrap items-center justify-center gap-2"
                                dir="rtl"></div>
                        </div>
                    </div>

                    <!-- Reuse your global loader with id="loader" (already created in your script) -->


                    <!--Add Users  -->
                    <div id="ms-page-add-user" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 id="ms-user-form-title" class="text-3xl md:text-4xl font-bold text-midnight_green">نیا
                                صارف شامل کریں</h1>
                            <a href="#manage-users"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <form id="ms-user-form" class="space-y-6">
                                <input type="hidden" id="ms-user-id">
                                <div>
                                    <label for="ms-user-name"
                                        class="block text-xl font-bold text-midnight_green mb-2">نام</label>
                                    <input type="text" id="ms-user-name"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg"
                                        required>
                                </div>
                                <div>
                                    <label for="ms-user-email"
                                        class="block text-xl font-bold text-midnight_green mb-2">ای میل</label>
                                    <input type="email" id="ms-user-email"
                                        class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg font-sans"
                                        style="direction: ltr;" required>
                                </div>
                                <div id="ms-password-section">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label for="ms-user-password"
                                                class="block text-xl font-bold text-midnight_green mb-2">پاس ورڈ</label>
                                            <input type="password" id="ms-user-password"
                                                class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg font-sans"
                                                style="direction: ltr;">
                                        </div>
                                        <div>
                                            <label for="ms-user-confirm-password"
                                                class="block text-xl font-bold text-midnight_green mb-2">پاس ورڈ کی
                                                تصدیق</label>
                                            <input type="password" id="ms-user-confirm-password"
                                                class="w-full py-3 px-4 border-2 border-ash_gray rounded-lg focus:outline-none focus:ring-2 focus:ring-midnight_green text-rich_black text-lg font-sans"
                                                style="direction: ltr;">
                                        </div>
                                    </div>
                                    <p id="ms-password-help-text" class="text-sm text-air_force_blue mt-1">نیا صارف
                                        بناتے وقت پاس ورڈ درکار ہے۔ ترمیم کرتے وقت، پاس ورڈ کو تبدیل کرنے کے لیے اسے
                                        خالی چھوڑ دیں۔</p>
                                </div>
                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button type="submit"
                                        class="w-full md:w-auto bg-midnight_green text-white py-3 px-8 rounded-lg text-lg hover:bg-midnight_green-400 transition">پبلش
                                        کریں</button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-users">منسوخ کریں</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div id="ms-page-manage-submissions" class="as-admin-page qalam-admin-page">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">مفتی کی گذارشات</h1>
                        </div>
                        <div class="bg-white p-2 md:p-6 rounded-xl shadow-lg">
                            <table class="w-full text-right text-lg as-responsive-table qalam-responsive-table">
                                <thead>
                                    <tr class="border-b-2 border-gray-200">
                                        <th class="py-3 px-4">عنوان</th>
                                        <th class="py-3 px-4">مفتی صاحب</th>
                                        <th class="py-3 px-4">تاریخ</th>
                                        <th class="py-3 px-4">کیفیت</th>
                                        <th class="py-3 px-4">اعمال</th>
                                    </tr>
                                </thead>
                                <tbody id="ms-submissions-table-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <div id="ms-page-review-submission" class="as-admin-page qalam-admin-page">
                        <div class="flex justify-between items-center mb-8">
                            <h1 class="text-3xl md:text-4xl font-bold text-midnight_green">گذارش کا جائزہ</h1>
                            <a href="#manage-submissions"
                                class="as-back-link as-admin-nav-link hidden md:flex items-center text-lg text-midnight_green hover:text-rich_black transition">
                                <i class="bi bi-arrow-right ml-2"></i>
                                فہرست پر واپس جائیں
                            </a>
                        </div>
                        <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <div class="space-y-6">
                                <input type="hidden" id="ms-review-submission-id">
                                <div>
                                    <h2 class="block text-xl font-bold text-midnight_green mb-2">عنوان</h2>
                                    <p id="ms-review-submission-title"
                                        class="w-full py-3 px-4 bg-gray-100 rounded-lg text-rich_black text-lg"></p>
                                </div>
                                <div>
                                    <h2 class="block text-xl font-bold text-midnight_green mb-2">مفتی صاحب</h2>
                                    <p id="ms-review-submission-mufti"
                                        class="w-full py-3 px-4 bg-gray-100 rounded-lg text-rich_black text-lg"></p>
                                </div>
                                <div>
                                    <h2 class="block text-xl font-bold text-midnight_green mb-2">سوال</h2>
                                    <div id="ms-review-submission-question"
                                        class="w-full p-4 bg-gray-100 rounded-lg text-rich_black text-lg prose max-w-none">
                                    </div>
                                </div>
                                <div>
                                    <h2 class="block text-xl font-bold text-midnight_green mb-2">الجواب</h2>
                                    <div id="ms-review-submission-answer"
                                        class="w-full p-4 bg-gray-100 rounded-lg text-rich_black text-lg prose max-w-none">
                                    </div>
                                </div>
                                <div
                                    class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 md:space-x-reverse pt-4">
                                    <button id="ms-approve-submission-btn"
                                        class="w-full md:w-auto bg-green-600 text-white py-3 px-8 rounded-lg text-lg hover:bg-green-700 transition">پبلش
                                        کریں</button>
                                    <button id="ms-reject-submission-btn"
                                        class="w-full md:w-auto bg-red-600 text-white py-3 px-8 rounded-lg text-lg hover:bg-red-700 transition">مسترد
                                        کریں</button>
                                    <button type="button"
                                        class="as-cancel-btn w-full md:w-auto bg-ash_gray text-rich_black py-3 px-8 rounded-lg text-lg hover:bg-ash_gray-400 transition"
                                        data-target="manage-submissions">منسوخ کریں</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <footer class="text-center py-4 mt-8 text-xs text-gray-400 font-sans">
                    Powered By www.AlQalamArts.com
                </footer>
            </main>
        </div>
    </div>

    <script src="./script.js"></script>
   <script>
document.addEventListener('DOMContentLoaded', function () {
  // --- Element refs (may or may not exist on a given view) ---
  const mainContent = document.getElementById('ms-admin-main-content');
  const recentActivitiesContainer = document.getElementById('ms-recent-activities');
  const sidebar = document.getElementById('ms-sidebar');
  const sidebarToggle = document.getElementById('ms-sidebar-toggle');
  const sidebarOverlay = document.getElementById('ms-sidebar-overlay');
  const breadcrumbContainer = document.getElementById('ms-breadcrumb');

  // --- State ---
  const activities = [];
  const quillInstances = {};
  const BREADCRUMB_MAP = {
    'dashboard': [{ name: 'ڈیش بورڈ' }],
    'manage-fatawa': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'فتاویٰ کا انتظام' }],
    'add-fatwa': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'فتاویٰ کا انتظام', link: '#manage-fatawa' }, { name: 'نیا/ترمیم فتویٰ' }],
    'manage-articles': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'مضامین کا انتظام' }],
    'add-article': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'مضامین کا انتظام', link: '#manage-articles' }, { name: 'نیا/ترمیم مضمون' }],
    'manage-books': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'کتابوں کا انتظام' }],
    'add-book': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'کتابوں کا انتظام', link: '#manage-books' }, { name: 'نئی/ترمیم کتاب' }],
    'manage-ulema': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'علمائے کرام کا انتظام' }],
    'add-ulema': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'علمائے کرام کا انتظام', link: '#manage-ulema' }, { name: 'نئے/ترمیم عالم' }],
    'manage-categories': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'موضوعات کا انتظام' }],
    'add-category': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'موضوعات کا انتظام', link: '#manage-categories' }, { name: 'نیا/ترمیم موضوع' }],
    'manage-questions': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'موصول سوالات' }],
    'answer-question': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'موصول سوالات', link: '#manage-questions' }, { name: 'سوال کا جواب' }],
    'manage-users': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'صارفین کا انتظام' }],
    'add-user': [{ name: 'ڈیش بورڈ', link: '#dashboard' }, { name: 'صارفین کا انتظام', link: '#manage-users' }, { name: 'نیا/ترمیم صارف' }],
  };

  // --- Utils ---
  const getPageIdFromHash = () => {
    const hash = window.location.hash.substring(1);
    return hash.split('?')[0] || 'dashboard';
  };

  function addActivity(icon, text, type, id) {
    const timestamp = new Date();
    activities.unshift({ icon, text, type, id, timestamp });
    if (activities.length > 20) activities.pop();
    renderActivities();
  }

  function renderActivities() {
    if (!recentActivitiesContainer) return;               // ✅ guard missing container
    if (!window.moment) return;
    recentActivitiesContainer.innerHTML = activities.map(act => {
      let href = '#';
      if (act.type) {
        switch (act.type) {
          case 'fatwa': href = `#add-fatwa?edit=${act.id}&type=fatwa`; break;
          case 'article': href = `#add-article?edit=${act.id}&type=article`; break;
          case 'book': href = `#add-book?edit=${act.id}&type=book`; break;
          case 'ulema': href = `#add-ulema?edit=${act.id}&type=ulema`; break;
          case 'category': href = `#add-category?edit=${act.id}&type=category`; break;
          case 'question': href = `#answer-question?edit=${act.id}&type=question`; break;
          case 'user': href = `#add-user?edit=${act.id}&type=user`; break;
          default: href = `#manage-${act.type}s`;
        }
      }
      const timeAgo = moment(act.timestamp).locale('ur').fromNow();
      const postDate = new Date(act.timestamp).toLocaleDateString('ur-PK', { day: 'numeric', month: 'short' });
      return `
        <a href="${href}" class="as-activity-link as-admin-nav-link block p-2 rounded-md hover:bg-gray-100 transition" data-id="${act.id}" data-type="${act.type}">
          <div class="flex items-center">
            <div class="p-2 ${act.icon?.bgColor || 'bg-gray-100'} rounded-full ml-4">
              <i class="${act.icon?.class || 'bi bi-info-circle'} ${act.icon?.textColor || 'text-gray-600'}"></i>
            </div>
            <div class="flex-grow">
              <span>${act.text}</span>
              <div class="text-air_force_blue text-sm font-sans">${postDate} - ${timeAgo}</div>
            </div>
          </div>
        </a>`;
    }).join('');
  }

  function toggleSidebar() {
    if (!sidebar || !sidebarOverlay) return;
    sidebar.classList.toggle('translate-x-full');
    sidebarOverlay.classList.toggle('hidden');
  }

  sidebarToggle?.addEventListener('click', toggleSidebar);
  sidebarOverlay?.addEventListener('click', toggleSidebar);

  function updateBreadcrumbs(pageId) {
    if (!breadcrumbContainer) return;
    const pageKey = pageId.includes('add-') ? pageId.replace('edit-', 'add-') : pageId;
    const path = BREADCRUMB_MAP[pageKey] || [{ name: 'ڈیش بورڈ' }];

    breadcrumbContainer.innerHTML = path.map((p, index) => {
      if (index === path.length - 1) {
        return `<span class="text-rich_black font-bold">${p.name}</span>`;
      } else {
        return `<a href="${p.link}" class="as-admin-nav-link text-midnight_green hover:underline">${p.name}</a><span class="mx-2 text-gray-400">/</span>`;
      }
    }).join('');
  }

  function initializeQuillEditor(editorId) {
    const node = document.getElementById(editorId);
    if (!node || quillInstances[editorId] || !window.Quill) return;

    const Font = Quill.import('formats/font');
    Font.whitelist = ['jameel', 'lateef', 'scheherazade', 'serif', 'sans-serif'];
    Quill.register(Font, true);

    const quill = new Quill(`#${editorId}`, {
      theme: 'snow',
      modules: {
        toolbar: [
          [{ 'font': Font.whitelist }],
          [{ 'header': [1, 2, 3, false] }],
          ['bold', 'italic', 'underline'],
          [{ 'list': 'ordered' }, { 'list': 'bullet' }],
          [{ 'align': [] }],
          ['link', 'image'],
          [{ 'direction': 'rtl' }],
          ['clean']
        ]
      }
    });
    quillInstances[editorId] = quill;

    quill.on('text-change', () => {
      const plainText = quill.getText();
      if (editorId === 'ms-fatwa-answer') {
        const meta = document.getElementById('ms-fatwa-meta-description');
        if (meta) meta.value = plainText.substring(0, 160).replace(/\n/g, ' ');
      } else if (editorId === 'ms-article-content') {
        const meta = document.getElementById('ms-article-meta-description');
        if (meta) meta.value = plainText.substring(0, 160).replace(/\n/g, ' ');
      }
    });
  }

  function showPage(pageId) {
    document.querySelectorAll('.as-admin-page').forEach(page => page.classList.remove('as-active', 'qalam-active'));
    const targetPage = document.getElementById('ms-page-' + pageId);
    if (targetPage) {
      targetPage.classList.add('as-active', 'qalam-active');
      targetPage.querySelectorAll('.qalam-rich-text-editor').forEach(editorDiv => {
        initializeQuillEditor(editorDiv.id);
      });
    } else {
      const dashboard = document.getElementById('ms-page-dashboard');
      dashboard?.classList.add('as-active', 'qalam-active');
    }
    window.scrollTo(0, 0);
    if (window.innerWidth < 768 && sidebar && !sidebar.classList.contains('translate-x-full')) {
      toggleSidebar();
    }
  }

  function handleHashChange() {
    const hash = window.location.hash.substring(1);
    const [pageId, paramsString] = hash.split('?');
    const params = new URLSearchParams(paramsString);
    const editId = params.get('edit');
    const editType = params.get('type');

    const pid = pageId || 'dashboard';
    showPage(pid);
    updateBreadcrumbs(pid);

    // (Optional) you can handle edit routing here by dispatching to your section modules.
    // e.g., if (pid === 'add-book' && editId) window.editBook?.(editId);

    document.querySelectorAll('.as-admin-nav-link').forEach(link => {
      const lhash = link.getAttribute('href')?.substring(1) || '';
      link.classList.toggle('qalam-active', lhash.startsWith(pid.split('-')[0]));
    });
  }

  function initApp() {
    moment?.locale?.('ur');

    // 🔕 No fake seed activities. This keeps renderActivities from touching a missing container at startup.
    // If you add a real activity later:
    // addActivity({ class: 'bi bi-pencil', textColor: 'text-yellow-600', bgColor: 'bg-yellow-100' }, 'حقیقی سرگرمی', 'article', 123);

    window.addEventListener('hashchange', handleHashChange);
    handleHashChange();
  }

  // Load moment (for time-ago) but don’t depend on it for safety.
  function loadScriptsAndInit() {
    const momentScript = document.createElement('script');
    momentScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js';
    momentScript.onload = () => {
      const momentUrdu = document.createElement('script');
      momentUrdu.src = 'https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/locale/ur.min.js';
      momentUrdu.onload = initApp;
      document.head.appendChild(momentUrdu);
    };
    momentScript.onerror = initApp; // proceed without moment
    document.head.appendChild(momentScript);
  }

  // One-time wires
  if (mainContent) {
    mainContent.addEventListener('input', e => {
      const targetId = e.target.id;
      if (targetId === 'ms-fatwa-title' || targetId === 'ms-article-title' || targetId === 'ms-category-name') {
        const slugInputId = targetId.replace('title', 'slug').replace('name', 'slug');
        const slugNode = document.getElementById(slugInputId);
        if (slugNode) {
          const text = e.target.value || '';
          const slug = text.toString().toLowerCase()
            .replace(/\s+/g, '-')
            .replace(/[^\u0600-\u06FF\w\-]+/g, '')
            .replace(/\-\-+/g, '-')
            .replace(/^-+/, '')
            .replace(/-+$/, '');
          slugNode.value = slug;
        }
      }
    });
  }

  loadScriptsAndInit();
});


document.addEventListener('click', function (e) {
  const btn = e.target.closest('.as-add-new-btn');
  if (!btn) return;

  const target = btn.getAttribute('data-target');
  if (target) {
    // Navigate to index.html#add-user or simply change hash
    window.location.hash = target;  // e.g., "#add-user"
  }
});
</script>


</body>

</html>